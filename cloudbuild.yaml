steps:
  # This step uses 'gsutil rsync' to efficiently synchronize the website files.
  # 'rsync' is faster as it only transfers changed files and the -d flag removes old files.
  - name: 'gcr.io/cloud-builders/gcloud'
    id: 'Sync Website to Cloud Storage'
    entrypoint: 'gsutil'
    # -d deletes destination files not in source, -r is for recursive sync.
    # The destination path 'gs://${_BUCKET_NAME}/visions/' deploys files to a 'visions' subdirectory.
    args: ['rsync', '-d', '-r', './static/', 'gs://${_BUCKET_NAME}/visions/']

# We use substitutions to make the build configuration more flexible and reusable.
# This allows you to define the bucket name without hardcoding it in the YAML file.
# You will set the value for _BUCKET_NAME when you create the trigger in the Google Cloud Console.
substitutions:
  _BUCKET_NAME: 'www.zudduz.com'

# Options to customize the build environment.
options:
  logging: 'CLOUD_LOGGING_ONLY'

timeout: '1200s'
